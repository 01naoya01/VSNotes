---
tags:
    - AntBook
---


p54の漸化式に置き換えても計算量が同じなのは，表のiとjは品物の数と重さを表していて，それを掛け算すれば表のマスの数と同じ数になる，つまり表を作るための計算と同じになる，だからO(nW)

LCSは問題文をちゃんと読んだ方がいい，部分文字列は連続した文字列である必要がないことに注意しないといけない
LCSの漸化式についてだが，(それ以外)のところは問題ないが，(s_i+1=t_j+1)の場合のところは，dp[i][j+1]とdp[i+1][j]は省略してよい

//個数制限なしナップサック問題について
ナップサック問題を見ればわかるが，漸化式と用いた動的計画法で解く場合，考え方として，dp[i+1][j]=i番目までの品物から重さの総和がj以下となるように選んだもの，とある．要するに1ずつjを増加させ，その時その時の最大を求めていく感じである．そして最終的にj=wの場合の最大が元々求めたかったものなので正解になる．この感じはメモ化と同じような感覚である．

p59の式について考える．この最初の式の

dp[i+1][j]=max{dp[i][j-k×w[i]]+k×v[i] | 0<=k}

この式をどうしたいかというと，kのループが嫌なのでこれをなくしたい．これは漸化式なので，漸化式を解くという基本的な気持ちに戻って考える，つまりこの式を式変形して，この式を利用するようにすればよい
この文で意味は分からないかもしれないが，以下を見れば分かるんじゃないかと思う．

dp[i+1][j]=max{dp[i][j-k×w[i]]+k×v[i] | 0<=k} = max(dp[i][j],max{dp[i][j-k×w[i]]+k×v[i] | 1<=k>})       …☆

この式変形は，単純にk=0だった場合についてmaxで分けてるだけである.この状態で，maxの右だけを変形して0<=kにすれば，元の式の形式になるので代入できる．(要するに次は0<=kを目指す>)

=max(dp[i][j],max{dp[i][(j-w[i])-k×w[i]] | 0<=k>}+v[i])

これはなぜこうなるかというと，式変形の目的からすれば，☆の式のk=1の場合が上の式のk=0の場合に一致するようにすればいい☆でk=1の場合はmaxの中は　dp[i][j-w[i]]+v[i]となる．これが目指す式(つまり上の式)のk=0の場合である．よって上のような式になる．v[i]が外に出せるのは，maxなので全部にv[i]足されてるもののmaxなのでv[i]を外に出しても問題は全くない．

そして次はmaxの中のmaxを最初の式の形式になっていることに気づいて代入する
つまり  dp[i+1][j-w[i]]+v[i]=max{dp[i][(j-w[i])-k×w[i]]+k×v[i] | 0<=k}+v[i]   であることに気づく，そして代入すると

=max(dp[i][j],dp[i+1][j-w[i]]+v[i])となる